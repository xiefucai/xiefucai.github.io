<!DOCTYPE html>
<html dir="ltr" lang="zh-CN">
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta charset="UTF-8">
		<title>历史速度</title>
		<script>
		var toSize = function(k, u, d) {
            var unit = 1024,
                r;
            if (d === undefined) {
                d = 2;
            }
            if (k === 0) {
                r = '0.00KB';
            } else if (k < unit) {
                r = (+k).toFixed(d) + 'B';
            } else if (k / unit < unit) {
                r = (k / unit).toFixed(d) + 'KB';
            } else if (k / unit / unit < unit) {
                r = (k / unit / unit).toFixed(d) + 'MB';
            } else if (k / unit / unit / unit < unit) {
                r = (k / unit / unit / unit).toFixed(d) + 'GB';
            } else {
                r = (k / unit / unit / unit / unit).toFixed(d) + 'TB';
            }
            r = r.replace(/\.0+(\D+)$/, '$1');
            if (u) {
                return r + '/' + u;
            } else {
                return r;
            }
        };
        
		function show(e){
		  var a=JSON.parse(e.value.replace(/[\s\n]/g,''));
		  console.log(a);
		  for(var i=0,k=a.length;i<k;i++) {
		    a[i] = toSize(a[i],'s');
		  }
		  e.value = a.join(', ');
		}</script>
</head>
<body>
  <form>
    <textarea rows="10" cols="80" name="code"></textarea>
  <div>
    <input type="button" onclick="show(this.form['code']);" value="查看速度" style="margin: 30px 0 0;color: #333;-webkit-appearance: none;display: inline-block;padding:10px 20px;background-color: #fff;border: 1px solid #ccc;border-radius: 5px;"/>
  </div>
  </form>
</body>
</html>