<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Wireless Router</title>
<link type="text/css" rel="stylesheet" href="common.css" media="screen" />
<script language="javascript" type="text/javascript" src="jquery-1.3.2.js"></script>
<script language="javascript" type="text/javascript" src="global.js"></script>
<script type="text/javascript">
var _flg_stop = 0;
var freshtime = 5;
var t;
$(function(){
	$('#INPUT_freshtime').unbind('keyup');
	chg_language(data_language['status_statistics.html']);
	Onload_init();
});
function Onload_init()
{
	var statistics;
	$.getJSON("dataCenter.js", {'/var/traffic_statistic.txt':'file'},function(json){
		statistics = json;
		setJSONValue({
				'INPUT_LAN1_PacketsSent'     : json['vlan1']['txPacktes'],
				'INPUT_LAN1_PacketsReceived' : json['vlan1']['rxPacktes'],
				'INPUT_LAN1_BytesSent'       : json['vlan1']['txBytes'],
				'INPUT_LAN1_BytesReceived'   : json['vlan1']['rxBytes'],
				
				'INPUT_WLAN_txpkts'          : parseInt(json['eth1']['txPacktes'])+parseInt(json['wl0.1']['txPacktes'])+parseInt(json['wl0.2']['txPacktes']),
				'INPUT_WLAN_rxpkts'          : parseInt(json['eth1']['rxPacktes'])+parseInt(json['wl0.1']['rxPacktes'])+parseInt(json['wl0.2']['rxPacktes']),
				'INPUT_WLAN_txbytes'         : parseInt(json['eth1']['txBytes'])+parseInt(json['wl0.1']['txBytes'])+parseInt(json['wl0.2']['txBytes']),
				'INPUT_WLAN_rxbytes'         : parseInt(json['eth1']['rxBytes'])+parseInt(json['wl0.1']['rxBytes'])+parseInt(json['wl0.2']['rxBytes']),
				
				'INPUT_WLAN_txpkts_5G'       : parseInt(json['eth2']['txPacktes'])+parseInt(json['wl1.1']['txPacktes'])+parseInt(json['wl1.2']['txPacktes']),
				'INPUT_WLAN_rxpkts_5G'       : parseInt(json['eth2']['rxPacktes'])+parseInt(json['wl1.1']['rxPacktes'])+parseInt(json['wl1.2']['rxPacktes']),
				'INPUT_WLAN_txbytes_5G'      : parseInt(json['eth2']['txBytes'])+parseInt(json['wl1.1']['txBytes'])+parseInt(json['wl1.2']['txBytes']),
				'INPUT_WLAN_rxbytes_5G'      : parseInt(json['eth2']['rxBytes'])+parseInt(json['wl1.1']['rxBytes'])+parseInt(json['wl1.2']['rxBytes'])
		});
		$.getJSON("dataCenter.js", {wan_proto:''},function(json){
			if(json.wan_proto == 'dhcp' ||json.wan_proto == 'static' ){
				setJSONValue({
					'INPUT_WAN_PacketsSent'      : statistics['vlan2']['txPacktes'],
					'INPUT_WAN_PacketsReceived'  : statistics['vlan2']['rxPacktes'],
					'INPUT_WAN_BytesSent'        : statistics['vlan2']['txBytes'],
					'INPUT_WAN_BytesReceived'    : statistics['vlan2']['rxBytes']
				});
			}else{
				if(statistics['ppp0'] != undefined)
					setJSONValue({
						'INPUT_WAN_PacketsSent'      : statistics['ppp0']['txPacktes'],
						'INPUT_WAN_PacketsReceived'  : statistics['ppp0']['rxPacktes'],
						'INPUT_WAN_BytesSent'        : statistics['ppp0']['txBytes'],
						'INPUT_WAN_BytesReceived'    : statistics['ppp0']['rxBytes']
					});
				else
					setJSONValue({
						'INPUT_WAN_PacketsSent'      : 0,
						'INPUT_WAN_PacketsReceived'  : 0,
						'INPUT_WAN_BytesSent'        : 0,
						'INPUT_WAN_BytesReceived'    : 0
					});
			}
		});
	});
		
	$("#INPUT_freshtime").val(freshtime);
	clearTimeout(t);
	if(_flg_stop == 0)
		t = setTimeout("Onload_init()",freshtime*1000);
}


function uiSetTime()
{
	var tmp=$("#INPUT_freshtime").val();
	if(tmp.match(/^\+?[1-9][0-9]*$/) == null)
	{
		alertError('InvalidTimeoutNum');
		return;
	}
	if((parseInt(tmp) > 86400)||(parseInt(tmp) < 1))
	{
		
		alertError('InvalidTimeoutLong');
		return;
	}
	freshtime = tmp;
	_flg_stop = 0;
	clearTimeout(t);
	setTimeout("Onload_init()",freshtime*1000);
}

function uiStop()
{
	_flg_stop = 1;
	clearTimeout(t);
}
</script>
</head>

<body>
<div class="config3">
<div><p class="mainbiao" id="lang_statistic_information"> Statistic Information </p></div>
<br />
<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" class="table01" >
<tbody >
    <tr align="center" >
        <td class="subhead"><div align="center" ><span id="lang_port"></span></div></td>
        <td class="subhead"><div align="center"><span id="lang_txpkts"></span></div></td>
        <td class="subhead"><div align="center"><span id="lang_rxpkts"></span></div></td>
        <td class="subhead"><div align="center"><span id="lang_txbs"></span></div></td>
        <td class="subhead"><div align="center"><span id="lang_rxbs"></span></div></td>
    </tr>
    <tr >
        <td class="subhead"><div align="center"><span id="lang_wan">WAN</span></div></td>
        <td ><div align="center"><div id="INPUT_WAN_PacketsSent"></div></div></td>
        <td ><div align="center"><div id="INPUT_WAN_PacketsReceived"></div></div></td>
        <td ><div align="center"><div id="INPUT_WAN_BytesSent"></div></div></td>
        <td ><div align="center" ><div id="INPUT_WAN_BytesReceived"></div></div></td>
    </tr>
    <tr>
        <td class="subhead"><div align="center"><span id="lang_lan1">LAN 1</span></div></td>
        <td rowspan="1"><div align="center" ><div id="INPUT_LAN1_PacketsSent"></div></div></td>
        <td rowspan="1"><div align="center" ><div id="INPUT_LAN1_PacketsReceived"></div></div></td>
        <td rowspan="1"><div align="center" ><div id="INPUT_LAN1_BytesSent"></div></div></td>
        <td rowspan="1"><div align="center" ><div id="INPUT_LAN1_BytesReceived"></div></div></td>
    </tr> 
    <tr>
        <td class="subhead"><div align="center"><span id="lang_wlan_2G">WLAN</span></div></td>
        <td ><div align="center" ><div id="INPUT_WLAN_txpkts"></div></div></td>
        <td ><div align="center" ><div id="INPUT_WLAN_rxpkts"></div></div></td>
        <td ><div align="center" ><div id="INPUT_WLAN_txbytes"></div></div></td>
        <td ><div align="center" ><div id="INPUT_WLAN_rxbytes"></div></div></td>
    </tr>
    
    <tr>
        <td class="subhead"><div align="center"><span id="lang_wlan_5G">WLAN</span></div></td>
        <td ><div align="center" ><div id="INPUT_WLAN_txpkts_5G"></div></div></td>
        <td ><div align="center" ><div id="INPUT_WLAN_rxpkts_5G"></div></div></td>
        <td ><div align="center" ><div id="INPUT_WLAN_txbytes_5G"></div></div></td>
        <td ><div align="center" ><div id="INPUT_WLAN_rxbytes_5G"></div></div></td>
    </tr>
    <tr>			   
    	<td colspan="5" class="lable"><span id="lang_poll_interval"> Poll Intervalï¼š</span></td>
    </tr>
    <tr>			   
   		<td colspan="5"><input type="text" id="INPUT_freshtime" maxlength="5" style="width:60px" value="5">
    <span id="lang_secs">(Secs)</span><input type="button" id="submit" value="Set Interval" onClick="uiSetTime();"/> 
    <input name="button" type="button" id="button" onclick="uiStop();" value="Stop"/> 
    </td>
    </tr>
</tbody>
</table>
</div>
</body>
</html>
